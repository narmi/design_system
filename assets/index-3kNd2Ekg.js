import{r as n}from"./iframe-JcdBEcwK.js";import{r as C}from"./raf-schd.esm-CmoV45_-.js";const E=()=>n.useMemo(()=>typeof CSS>"u"||typeof CSS.supports!="function"?!1:[CSS.supports("anchor-name","--my-anchor"),CSS.supports("position-anchor","--my-anchor"),CSS.supports("position-area","bottom center"),CSS.supports("position-try-fallbacks","flip-block")].every(Boolean),[]),L=({anchorRef:r,layerRef:p,matchWidth:s=!1,isOpen:c,setIsOpen:i})=>{const l=E();return n.useLayoutEffect(()=>{if(l||!c)return;const t=r.current,o=p.current;if(!t||!o)return;const e=t.getBoundingClientRect(),d=o.getBoundingClientRect();if(e.width===0||d.width===0)return;const f=window.visualViewport?.height||window.innerHeight,a=window.visualViewport?.offsetTop||0,S=f-(e.bottom-a),g=e.top-a,P=d.height>S&&g>S;let v=e.left,w=P?e.top-d.height:e.bottom;const h=o.offsetParent;if(h&&h!==document.body){const m=h.getBoundingClientRect();v=e.left-m.left,w=w-m.top}o.style.setProperty("--js-dropdown-top",`${w}px`),o.style.setProperty("--js-dropdown-left",`${v}px`),o.style.setProperty("--js-dropdown-minWidth","max-content"),s&&o.style.setProperty("--js-dropdown-width",`${e.width}px`);const b=e.top,y=C(()=>{Math.abs(t.getBoundingClientRect().top-b)>20&&i(!1)}),u=()=>i(!1);return window.addEventListener("scroll",y,!0),window.addEventListener("resize",u),window.visualViewport?.addEventListener("resize",u),()=>{y.cancel(),window.removeEventListener("scroll",y,!0),window.removeEventListener("resize",u),window.visualViewport?.removeEventListener("resize",u)}},[l,r,p,s,c,i]),{isAnchorPositionSupported:l,polyFillLayerStyles:l?{}:{position:"fixed",top:"var(--js-dropdown-top)",left:"var(--js-dropdown-left)",minWidth:"var(--js-dropdown-minWidth)",...s&&{width:"var(--js-dropdown-width)"}}}},A=({isOpen:r,setIsOpen:p,matchWidth:s=!0})=>{const c=n.useRef(null),i=n.useRef(null),l=n.useId().replaceAll(/:/g,"-"),t=n.useMemo(()=>`--nds-dropdown-anchor-${l}`,[l]),{isAnchorPositionSupported:o,polyFillLayerStyles:e}=L({anchorRef:c,layerRef:i,matchWidth:s,isOpen:r,setIsOpen:p}),d=n.useMemo(()=>({ref:c,style:{anchorName:o?t:void 0}}),[c,o,t]),f=n.useMemo(()=>{const a={...o?{position:"absolute",positionAnchor:t,positionArea:"bottom start",positionTryFallbacks:"flip-block",width:"max-content",minWidth:s?"anchor-size(width)":void 0}:e,display:r?"block":"none",zIndex:4};return{ref:i,style:a}},[r,o,t,s,e,i]);return{anchorProps:d,layerProps:f}};export{A as u};
