import{r as o}from"./iframe-DxB44bOA.js";const m=()=>o.useMemo(()=>typeof CSS>"u"||typeof CSS.supports!="function"?!1:[CSS.supports("anchor-name","--my-anchor"),CSS.supports("position-anchor","--my-anchor"),CSS.supports("position-area","bottom center"),CSS.supports("position-try-fallbacks","flip-block")].every(Boolean),[]),v=({anchorRef:c,layerRef:l,matchWidth:p=!1,isOpen:i})=>{const r=m(),e=o.useRef(),n=o.useCallback(()=>{if(!i)return;const u=c.current,a=l.current;if(!u||!a)return;const s=u.getBoundingClientRect(),d=a.getBoundingClientRect();if(s.width===0||d.width===0)return;const f=(window.visualViewport?.height||window.innerHeight)-s.bottom,y=s.top,h=d.height>f&&y>f,w=window.visualViewport?.offsetTop||0,S=h?s.top-d.height+w:s.bottom+w;a.style.setProperty("--js-dropdown-top",`${S}px`),a.style.setProperty("--js-dropdown-left",`${s.left}px`),p&&a.style.setProperty("--js-dropdown-width",`${s.width}px`)},[c,l,p,i]),t=o.useCallback(()=>{e.current&&cancelAnimationFrame(e.current),e.current=requestAnimationFrame(n)},[n]);return o.useLayoutEffect(()=>{if(!r)return n(),window.visualViewport?.addEventListener("scroll",t),window.visualViewport?.addEventListener("resize",t),()=>{window.visualViewport?.removeEventListener("scroll",t),window.visualViewport?.removeEventListener("resize",t),e.current&&cancelAnimationFrame(e.current)}},[r,n,t]),o.useLayoutEffect(()=>{r||!i||t()},[i,r,t]),{isAnchorPositionSupported:r,polyFillLayerStyles:r?{}:{position:"fixed",top:"var(--js-dropdown-top)",left:"var(--js-dropdown-left)",...p&&{width:"var(--js-dropdown-width)"}}}},A=({isOpen:c,matchWidth:l=!0})=>{const p=o.useRef(null),i=o.useRef(null),r=o.useId().replaceAll(/:/g,"-"),e=o.useMemo(()=>`--nds-dropdown-anchor-${r}`,[r]),{isAnchorPositionSupported:n,polyFillLayerStyles:t}=v({anchorRef:p,layerRef:i,matchWidth:l,isOpen:c}),u=o.useMemo(()=>({ref:p,style:{anchorName:n?e:void 0}}),[p,n,e]),a=o.useMemo(()=>{const s={...n?{position:"absolute",positionAnchor:e,positionArea:"bottom center",positionTryFallbacks:"flip-block",width:l?"anchor-size(width)":"max-content"}:t,display:c?"block":"none",zIndex:4};return{ref:i,style:s}},[c,n,e,l,t,i]);return{anchorProps:u,layerProps:a}};export{A as u};
