import{r as n}from"./iframe-CTHFVwiB.js";import{r as C}from"./raf-schd.esm-CmoV45_-.js";const E=()=>n.useMemo(()=>typeof CSS>"u"||typeof CSS.supports!="function"?!1:[CSS.supports("anchor-name","--my-anchor"),CSS.supports("position-anchor","--my-anchor"),CSS.supports("position-area","bottom center"),CSS.supports("position-try-fallbacks","flip-block")].every(Boolean),[]),L=({anchorRef:r,layerRef:p,matchWidth:s=!1,isOpen:l,setIsOpen:i})=>{const c=E();return n.useLayoutEffect(()=>{if(c||!l)return;const t=r.current,e=p.current;if(!t||!e)return;const o=t.getBoundingClientRect(),a=e.getBoundingClientRect();if(o.width===0||a.width===0)return;const f=window.visualViewport?.height||window.innerHeight,d=window.visualViewport?.offsetTop||0,v=f-(o.bottom-d),g=o.top-d,b=a.height>v&&g>v;let m=o.left,w=b?o.top-a.height:o.bottom;const h=e.offsetParent;if(h&&h!==document.body){const S=h.getBoundingClientRect();m=o.left-S.left,w=w-S.top}e.style.setProperty("--js-dropdown-top",`${w}px`),e.style.setProperty("--js-dropdown-left",`${m}px`),s&&e.style.setProperty("--js-dropdown-width",`${o.width}px`);const P=o.top,y=C(()=>{Math.abs(t.getBoundingClientRect().top-P)>20&&i(!1)}),u=()=>i(!1);return window.addEventListener("scroll",y,!0),window.addEventListener("resize",u),window.visualViewport?.addEventListener("resize",u),()=>{y.cancel(),window.removeEventListener("scroll",y,!0),window.removeEventListener("resize",u),window.visualViewport?.removeEventListener("resize",u)}},[c,r,p,s,l,i]),{isAnchorPositionSupported:c,polyFillLayerStyles:c?{}:{position:"fixed",top:"var(--js-dropdown-top)",left:"var(--js-dropdown-left)",...s&&{width:"var(--js-dropdown-width)"}}}},x=({isOpen:r,setIsOpen:p,matchWidth:s=!0})=>{const l=n.useRef(null),i=n.useRef(null),c=n.useId().replaceAll(/:/g,"-"),t=n.useMemo(()=>`--nds-dropdown-anchor-${c}`,[c]),{isAnchorPositionSupported:e,polyFillLayerStyles:o}=L({anchorRef:l,layerRef:i,matchWidth:s,isOpen:r,setIsOpen:p}),a=n.useMemo(()=>({ref:l,style:{anchorName:e?t:void 0}}),[l,e,t]),f=n.useMemo(()=>{const d={...e?{position:"absolute",positionAnchor:t,positionArea:"bottom center",positionTryFallbacks:"flip-block",width:s?"anchor-size(width)":"max-content"}:o,display:r?"block":"none",zIndex:4};return{ref:i,style:d}},[r,e,t,s,o,i]);return{anchorProps:a,layerProps:f}};export{x as u};
